---
- name: create virtual environment
  command: pyvenv {{ venv_dir }}
  args:
    creates: "{{ venv_dir }}"

- name: ensure git is installed
  dnf: name=git
  become: yes

- name: fetch source code
  git: dest="{{ code_dir }}" repo="{{ repo_url }}" accept_hostkey=yes

- name: install requirements in virtual environment
  pip: requirements="{{ req_path }}" virtualenv="{{ venv_dir }}"

- name: create dev script
  template:
    src: start_lokanhomepage_dev_server.sh.j2
    dest: ~/start_lokanhomepage_dev_server.sh
    mode: u+x
